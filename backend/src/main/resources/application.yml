# ─────────────────────────────────────────────────────────────────────────────
# Shared config. Datasource and JPA are in profile-specific files:
#   local — H2 in-memory, dev;  prod — PostgreSQL, deployment (Render).
# ─────────────────────────────────────────────────────────────────────────────

spring:
  application:
    name: nexaedi
  profiles:
    active: local
  threads:
    virtual:
      enabled: true
  jackson:
    time-zone: UTC
  servlet:
    multipart:
      enabled: true
      max-file-size: 50MB
      max-request-size: 50MB

server:
  port: 8080
  servlet:
    context-path: /
  compression:
    enabled: true
    mime-types: application/json,application/xml,text/plain

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,env
  endpoint:
    health:
      show-details: always
  info:
    env:
      enabled: true

info:
  app:
    name: NexaEDI
    description: High-performance, open-source EDI Orchestration Platform
    version: 1.0.0-SNAPSHOT

nexaedi:
  auth:
    jwt-secret: ${JWT_SECRET:nexaedi-super-secret-key-must-be-at-least-32-chars-2026!}
    jwt-expiry-ms: 86400000
  mappings:
    directory: ${NEXAEDI_MAPPINGS_DIR:src/main/resources/mappings}
  s3:
    region: ${AWS_REGION:us-east-1}
    bucket-name: ${S3_BUCKET_NAME:nexaedi-edi-files-dev}
    inbound-prefix: edi/inbound/
    processed-prefix: edi/processed/
  shopify:
    store-name: ${SHOPIFY_STORE_NAME:your-store}
    client-id: ${SHOPIFY_CLIENT_ID:changeme}
    client-secret: ${SHOPIFY_CLIENT_SECRET:changeme}
    api-version: 2026-01
    bucket-capacity: 40
    refill-rate-per-second: 2
    max-retry-attempts: 3
    retry-backoff-ms: 1000

logging:
  level:
    com.nexaedi: DEBUG
    org.springframework.web: INFO
    org.hibernate.SQL: WARN
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level [%X{correlationId}] %logger{36} - %msg%n"
